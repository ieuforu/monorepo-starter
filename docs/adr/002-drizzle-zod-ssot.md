# ADR 002: 基于 Drizzle-Zod 的全链路类型闭环

## 状态
已接受 (Accepted)

## 背景
在传统全栈项目中，数据库字段、后端校验逻辑（Zod/Joi）和前端类型定义（Interface）通常是手动同步的。这种模式在项目快速迭代时极易产生字段不一致导致的运行时错误（Runtime Errors）。

## 决策
引入 `drizzle-zod`，将 **Drizzle Schema** 作为“单一事实源 (SSOT)”，自动推导出 Zod Schema 和 TypeScript 类型。

## 理由
1. **自动同步**：修改数据库 Schema 后，校验层和类型层会自动更新，将由于漏改字段引发的 Bug 拦截在编译阶段。
2. **减少冗余**：利用 Zod 的 `.extend()`、`.pick()` 和 `.omit()` 在数据库模型基础上进行业务增强，无需从零手写 Schema。
3. **性能**：推导过程在编译/类型检查阶段完成，不影响运行时性能。

## 后果
* **优点**：极大提升了开发效率和系统的健壮性，实现了“代码即契约”。
* **影响**：包之间产生了逻辑耦合（`validators` 依赖 `db`），但在 Monorepo 架构下，这种耦合通过本地 Workspace 协议得到了很好的管理。